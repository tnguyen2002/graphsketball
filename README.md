# Graphsketball: Predicting NBA Player Chemistry with Graph Neural Networks (GNNs)
By Josh Francis and Tom Nguyen 


Graphsketball is an innovative project that applies Graph Neural Networks (GNNs) to uncover insights into NBA player relationships, team dynamics, and trade optimization. By leveraging cutting-edge machine learning, Graphsketball bridges the gap between analytics and the intangibles of player synergy, providing data-driven solutions for team performance enhancement.

## 🚀 Project Goals

1. **Predict NBA Team Rankings**: Utilize GNNs to forecast team win percentages based on player stats and team structures.
2. **Optimize Trades**: Provide data-driven recommendations for win-win trades that benefit both teams.

## 📊 Dataset Creation

Graphsketball represents the NBA as a graph, leveraging data from the [Basketball Reference GitHub repository](https://github.com/basketball-reference) spanning 1999 to 2022.

### Graph Structures

- **Player-Level Graphs**:
  - **Nodes**: 1,383 unique players, enriched with features like assist percentage, box plus-minus, PER, and usage percentage.
  - **Edges**: Connections between players indicate they played on the same team during a season.

- **Team-Level Graphs**:
  - **Nodes**: NBA teams with aggregated player embeddings.
  - **Edges**: Fully connected graph capturing team-to-team dynamics.

## 🧠 GNN Architecture

Graphsketball employs a hierarchical GNN model:

1. **1-Layer GNN**:
   - Input: Player-level subgraphs for a team in a specific season.
   - Output: Predicted win percentages based on individual player stats.

2. **2-Layer GNN**:
   - Input: Embeddings generated by the 1-layer GNN.
   - Output: Team-wide embeddings used in a league graph.

3. **League GNN**:
   - Combines hierarchical modeling to analyze inter-team dynamics.
   - Loss functions include Pairwise Ranking Loss and KL-Divergence-based Distribution Loss.

## ⚙️ Implementation Details

- **Frameworks**: Built using PyTorch and PyTorch Geometric.
- **Data Pipeline**:
  - Player-level JSON parsing and graph creation.
  - Training, validation, and testing splits for seasonal data.
- **Model Training**:
  - 300+ epochs using hybrid loss functions for robust predictions.
  - Incorporates GCNConv layers, global pooling, and normalization techniques.

## 🔑 Key Insights and Results

### Team Win Percentage Predictions
- Accurate predictions for team win percentages

### Trade Optimization
- Simulate trade scenarios by swapping player embeddings:
  - Example: Swapping Stephen Curry (Golden State Warriors) with Jalen Williams (Oklahoma City Thunder) improves the Warriors' win probability by **0.1040** and the Thunder by **0.0022**.
    
## 📈 Future Directions

- Incorporate positional and play-style embeddings.
- Integrate real-time game data for dynamic in-season updates.
- Extend the model to other sports or collaborative industries.

### 🔗 Links

- [Basketball Reference GitHub Repository](https://github.com/basketball-reference)
---
